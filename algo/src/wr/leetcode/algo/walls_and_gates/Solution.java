package wr.leetcode.algo.walls_and_gates;

import java.util.*;
import java.util.concurrent.SynchronousQueue;

public class Solution {
    public void wallsAndGates(int[][] rooms) {
        if( null != rooms && rooms.length > 0 && rooms[0].length > 0) {
            int h = rooms.length;
            int w = rooms[0].length;

            for (int i = 0; i < h; ++i) {
                for (int j = 0; j < w; ++j ) {
                    if(0 == rooms[i][j]) {
                        bfs(rooms, i,j);
                    }
                }
            }
        }
    }

    public void bfs(int[][] rooms, int i, int j) {
        int [] dx = {-1, 0, 0, 1};
        int [] dy = {0, -1, +1, 0};

        int h = rooms.length;
        int w = rooms[0].length;
        Queue<Pos> q = new LinkedList<>();
        q.offer(new Pos(i,j,0));
        Set<Integer> visited = new HashSet<>();
        visited.add(w*i + j);

        while(!q.isEmpty()) {
            Pos v = q.poll();
            for (int k = 0; k< 4; ++k) {
                int nx = v.x + dx[k];
                int ny = v.y + dy[k];
                int ndist = v.dist + 1;
                int key = w*nx + ny;
                if(nx > -1 && nx < h && ny > -1 && ny < w
                        && rooms[nx][ny] != -1
                        && rooms[nx][ny] != 0   //TLE BUG: should check 0 as well
                    && !visited.contains(key)) {
                    visited.add(key);
                    q.offer(new Pos(nx, ny, ndist));
                    if(ndist < rooms[nx][ny]){
                        rooms[nx][ny] = ndist;
                    }
                }
            }
        }
    }

    class Pos {
        int x;
        int y;
        int dist;
        public Pos (int x, int y, int dist) {
            this.x = x;
            this.y = y;
            this.dist = dist;
        }
    }


    public static void main(String[] args) {
        Solution sol = new Solution();
        int[][] rooms = {
                {Integer.MAX_VALUE,  -1,  0,  Integer.MAX_VALUE},
                {Integer.MAX_VALUE,  Integer.MAX_VALUE,  Integer.MAX_VALUE,  -1},
                {Integer.MAX_VALUE,  -1,  Integer.MAX_VALUE,  -1},
                {0,  -1,  Integer.MAX_VALUE,  Integer.MAX_VALUE},
        };
        int[][] rooms2 = {{-1,0,-1,0,2147483647,-1,2147483647,2147483647,2147483647,2147483647,-1,2147483647,0,-1,-1,2147483647,-1,0,2147483647,-1,2147483647,-1,0,-1,0,2147483647,2147483647,-1,2147483647,-1,0,-1,0,-1,2147483647,-1,2147483647,0,2147483647,-1,-1},{-1,-1,2147483647,2147483647,2147483647,2147483647,-1,2147483647,0,-1,-1,-1,2147483647,0,2147483647,2147483647,0,2147483647,2147483647,-1,0,-1,2147483647,2147483647,2147483647,0,0,0,0,0,-1,-1,-1,2147483647,2147483647,2147483647,2147483647,2147483647,2147483647,2147483647,-1},{-1,2147483647,0,0,0,2147483647,0,0,-1,0,2147483647,0,0,0,2147483647,-1,2147483647,2147483647,0,-1,2147483647,0,0,-1,-1,0,-1,2147483647,0,0,2147483647,2147483647,2147483647,0,-1,0,0,-1,0,-1,-1},{2147483647,-1,2147483647,-1,2147483647,2147483647,2147483647,0,0,-1,-1,-1,2147483647,0,2147483647,2147483647,-1,-1,2147483647,2147483647,-1,-1,0,0,2147483647,-1,0,-1,0,-1,2147483647,-1,-1,-1,0,0,0,0,2147483647,-1,2147483647},{-1,-1,-1,-1,0,-1,2147483647,-1,0,-1,-1,0,0,2147483647,-1,0,-1,-1,0,-1,2147483647,0,-1,2147483647,0,-1,2147483647,2147483647,0,0,2147483647,0,-1,2147483647,2147483647,-1,2147483647,-1,0,2147483647,0},{0,-1,0,2147483647,2147483647,2147483647,2147483647,0,0,-1,-1,-1,2147483647,-1,0,-1,-1,2147483647,-1,-1,-1,0,-1,2147483647,-1,0,2147483647,2147483647,2147483647,2147483647,0,2147483647,-1,0,2147483647,2147483647,-1,2147483647,-1,0,0},{2147483647,0,2147483647,-1,2147483647,-1,0,0,0,0,2147483647,2147483647,0,0,2147483647,-1,0,0,2147483647,0,2147483647,-1,0,0,0,-1,-1,2147483647,2147483647,0,-1,-1,0,2147483647,-1,-1,-1,2147483647,2147483647,-1,2147483647},{0,0,0,0,0,2147483647,0,-1,0,2147483647,0,0,0,-1,0,-1,-1,-1,0,2147483647,2147483647,0,-1,2147483647,-1,0,-1,2147483647,0,-1,0,-1,-1,0,-1,2147483647,0,2147483647,-1,0,0},{-1,-1,-1,2147483647,-1,2147483647,0,-1,0,-1,-1,0,0,-1,2147483647,0,0,2147483647,0,2147483647,0,2147483647,-1,2147483647,0,2147483647,-1,2147483647,-1,2147483647,-1,2147483647,2147483647,2147483647,2147483647,0,-1,0,-1,-1,0},{2147483647,2147483647,2147483647,2147483647,0,0,0,2147483647,2147483647,-1,2147483647,0,-1,-1,2147483647,-1,-1,2147483647,2147483647,-1,-1,2147483647,2147483647,-1,-1,-1,2147483647,2147483647,2147483647,2147483647,-1,-1,0,-1,2147483647,0,0,2147483647,-1,0,0},{2147483647,-1,2147483647,0,-1,2147483647,-1,-1,0,2147483647,2147483647,0,-1,-1,0,2147483647,0,2147483647,2147483647,-1,2147483647,-1,0,-1,0,2147483647,0,2147483647,-1,0,2147483647,0,2147483647,0,0,2147483647,0,2147483647,0,-1,-1},{-1,0,0,-1,-1,2147483647,-1,2147483647,0,-1,0,-1,0,0,-1,0,-1,0,0,0,-1,2147483647,-1,-1,-1,0,0,2147483647,-1,2147483647,2147483647,0,2147483647,2147483647,2147483647,-1,-1,-1,-1,2147483647,0},{2147483647,2147483647,2147483647,-1,2147483647,0,0,2147483647,2147483647,2147483647,-1,-1,-1,-1,2147483647,-1,-1,2147483647,0,2147483647,0,2147483647,-1,0,0,2147483647,0,2147483647,0,2147483647,2147483647,-1,2147483647,2147483647,0,-1,0,-1,-1,0,-1},{-1,0,-1,-1,-1,0,2147483647,0,-1,-1,0,0,0,2147483647,0,0,2147483647,2147483647,-1,0,0,0,0,0,0,0,2147483647,-1,0,0,0,2147483647,-1,0,2147483647,0,-1,0,2147483647,-1,0},{2147483647,-1,0,-1,-1,0,-1,-1,-1,2147483647,-1,-1,-1,-1,-1,2147483647,-1,0,-1,2147483647,2147483647,0,0,-1,0,0,2147483647,0,2147483647,-1,0,0,0,0,0,2147483647,-1,0,0,2147483647,-1},{2147483647,0,-1,-1,-1,-1,2147483647,0,2147483647,-1,-1,2147483647,-1,0,0,2147483647,2147483647,-1,2147483647,-1,-1,2147483647,2147483647,2147483647,-1,0,0,2147483647,0,-1,0,2147483647,2147483647,2147483647,-1,-1,-1,-1,-1,0,0},{2147483647,2147483647,2147483647,-1,0,2147483647,2147483647,-1,2147483647,0,2147483647,2147483647,2147483647,2147483647,2147483647,-1,2147483647,-1,-1,-1,-1,0,0,-1,2147483647,-1,2147483647,2147483647,0,2147483647,0,-1,-1,2147483647,2147483647,0,-1,0,-1,-1,-1},{0,0,0,-1,2147483647,0,-1,-1,2147483647,2147483647,0,-1,2147483647,2147483647,-1,2147483647,-1,2147483647,-1,2147483647,-1,0,-1,2147483647,0,2147483647,2147483647,2147483647,0,2147483647,2147483647,-1,2147483647,2147483647,0,0,0,2147483647,-1,0,0},{0,0,0,0,2147483647,-1,2147483647,2147483647,-1,-1,0,2147483647,2147483647,-1,0,2147483647,0,2147483647,-1,2147483647,0,-1,-1,0,0,2147483647,-1,-1,-1,2147483647,0,0,2147483647,2147483647,2147483647,2147483647,-1,-1,-1,0,0},{2147483647,2147483647,2147483647,2147483647,0,0,2147483647,0,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,2147483647,-1,-1,-1,2147483647,0,0,-1,2147483647,2147483647,2147483647,-1,2147483647,-1,2147483647,2147483647,-1,2147483647,0,0,2147483647},{-1,2147483647,-1,0,0,0,2147483647,-1,2147483647,-1,-1,-1,2147483647,0,-1,0,2147483647,0,-1,2147483647,2147483647,2147483647,2147483647,-1,-1,0,0,0,2147483647,2147483647,0,-1,2147483647,2147483647,2147483647,2147483647,2147483647,-1,2147483647,2147483647,2147483647},{-1,-1,0,2147483647,2147483647,-1,0,2147483647,2147483647,0,2147483647,-1,2147483647,0,-1,0,-1,0,0,0,0,2147483647,0,0,2147483647,2147483647,0,2147483647,0,2147483647,0,-1,0,2147483647,0,-1,0,0,2147483647,2147483647,2147483647},{-1,0,2147483647,-1,2147483647,-1,2147483647,2147483647,0,0,2147483647,0,-1,2147483647,2147483647,2147483647,-1,-1,2147483647,2147483647,2147483647,2147483647,0,2147483647,2147483647,0,0,2147483647,0,0,2147483647,-1,-1,-1,2147483647,0,0,2147483647,0,-1,-1},{-1,-1,0,0,0,0,0,-1,-1,2147483647,-1,-1,2147483647,2147483647,2147483647,2147483647,2147483647,0,2147483647,2147483647,-1,0,-1,2147483647,2147483647,-1,0,0,2147483647,-1,2147483647,-1,-1,0,2147483647,-1,2147483647,-1,-1,2147483647,0},{0,0,2147483647,-1,2147483647,2147483647,-1,2147483647,-1,-1,0,0,-1,0,2147483647,-1,2147483647,-1,-1,-1,0,-1,0,-1,-1,0,2147483647,2147483647,0,0,0,0,2147483647,-1,2147483647,-1,-1,-1,2147483647,-1,2147483647},{0,-1,2147483647,0,2147483647,2147483647,0,0,-1,-1,2147483647,2147483647,0,2147483647,2147483647,0,-1,0,0,2147483647,2147483647,2147483647,2147483647,0,0,-1,2147483647,0,0,-1,0,0,0,-1,0,0,-1,0,-1,0,2147483647},{2147483647,0,0,-1,2147483647,0,-1,-1,0,-1,-1,2147483647,0,2147483647,2147483647,2147483647,2147483647,2147483647,2147483647,0,2147483647,2147483647,0,-1,0,-1,2147483647,2147483647,2147483647,2147483647,0,-1,0,0,0,2147483647,0,2147483647,2147483647,-1,0},{2147483647,2147483647,0,-1,0,-1,0,-1,2147483647,0,0,0,0,-1,2147483647,2147483647,-1,2147483647,-1,0,-1,-1,-1,0,-1,-1,-1,0,0,2147483647,2147483647,2147483647,0,2147483647,0,-1,-1,2147483647,2147483647,-1,2147483647},{0,2147483647,2147483647,2147483647,0,0,0,2147483647,2147483647,0,2147483647,0,0,-1,-1,2147483647,0,0,0,-1,0,2147483647,0,0,-1,0,2147483647,-1,-1,2147483647,0,-1,2147483647,-1,0,0,0,-1,2147483647,0,0},{-1,2147483647,-1,-1,2147483647,-1,2147483647,0,0,-1,0,0,0,2147483647,0,2147483647,2147483647,-1,2147483647,-1,0,-1,0,0,0,2147483647,0,2147483647,0,-1,-1,0,0,2147483647,-1,-1,2147483647,0,2147483647,2147483647,-1},{-1,-1,2147483647,-1,0,0,-1,0,-1,2147483647,2147483647,0,0,-1,0,-1,0,2147483647,0,2147483647,0,-1,-1,0,0,0,0,0,-1,-1,2147483647,-1,0,-1,-1,0,-1,2147483647,0,0,2147483647},{0,-1,-1,2147483647,-1,2147483647,-1,2147483647,2147483647,2147483647,2147483647,0,0,2147483647,2147483647,2147483647,-1,0,0,-1,0,-1,2147483647,0,2147483647,2147483647,2147483647,2147483647,2147483647,2147483647,2147483647,2147483647,2147483647,-1,-1,2147483647,0,-1,-1,2147483647,0},{-1,2147483647,2147483647,-1,0,2147483647,0,2147483647,2147483647,0,-1,2147483647,-1,-1,0,2147483647,0,-1,2147483647,2147483647,0,-1,-1,2147483647,2147483647,2147483647,2147483647,0,-1,2147483647,-1,2147483647,-1,2147483647,0,0,2147483647,-1,0,0,-1},{2147483647,0,-1,0,2147483647,2147483647,2147483647,-1,2147483647,-1,-1,2147483647,2147483647,-1,-1,0,0,2147483647,0,0,-1,2147483647,-1,0,-1,-1,2147483647,-1,-1,-1,0,-1,-1,2147483647,0,2147483647,0,2147483647,2147483647,2147483647,-1},{2147483647,2147483647,-1,2147483647,2147483647,2147483647,2147483647,0,0,2147483647,0,0,0,0,-1,2147483647,0,0,0,2147483647,2147483647,2147483647,-1,-1,2147483647,2147483647,-1,2147483647,0,2147483647,-1,-1,-1,-1,0,2147483647,2147483647,0,-1,0,2147483647},{2147483647,-1,2147483647,0,-1,-1,0,2147483647,-1,2147483647,-1,-1,-1,0,0,-1,0,2147483647,2147483647,-1,0,-1,-1,-1,2147483647,-1,2147483647,0,0,2147483647,0,2147483647,0,2147483647,-1,2147483647,-1,0,2147483647,-1,0},{-1,2147483647,-1,2147483647,2147483647,-1,-1,2147483647,2147483647,2147483647,-1,0,2147483647,0,-1,-1,2147483647,-1,-1,2147483647,0,2147483647,-1,0,0,2147483647,2147483647,-1,-1,-1,0,0,0,0,0,2147483647,0,-1,0,0,2147483647},{-1,0,0,0,-1,2147483647,-1,-1,0,2147483647,2147483647,2147483647,-1,-1,-1,-1,2147483647,0,2147483647,0,2147483647,2147483647,0,-1,2147483647,0,-1,-1,-1,2147483647,2147483647,0,0,-1,-1,2147483647,2147483647,0,-1,-1,-1},{-1,-1,2147483647,2147483647,0,0,0,-1,2147483647,0,0,-1,-1,0,-1,-1,0,0,0,-1,0,0,-1,-1,2147483647,-1,2147483647,2147483647,-1,0,2147483647,2147483647,2147483647,-1,-1,0,2147483647,0,-1,0,-1},{0,0,0,0,0,0,0,2147483647,2147483647,-1,-1,-1,-1,2147483647,-1,0,-1,-1,2147483647,-1,0,0,2147483647,-1,2147483647,0,0,0,-1,2147483647,-1,0,2147483647,2147483647,0,2147483647,-1,-1,0,-1,-1},{2147483647,2147483647,-1,0,0,-1,0,2147483647,-1,0,-1,-1,-1,-1,2147483647,0,-1,-1,0,2147483647,-1,0,2147483647,-1,-1,0,2147483647,2147483647,2147483647,-1,2147483647,2147483647,0,-1,0,2147483647,-1,0,2147483647,-1,0},{2147483647,0,0,-1,0,0,2147483647,0,-1,-1,2147483647,0,-1,2147483647,-1,0,2147483647,0,2147483647,2147483647,-1,2147483647,2147483647,-1,-1,2147483647,-1,-1,2147483647,0,0,-1,2147483647,0,-1,2147483647,0,-1,-1,2147483647,-1},{2147483647,-1,-1,-1,0,2147483647,-1,0,2147483647,0,0,-1,0,-1,2147483647,-1,2147483647,-1,2147483647,2147483647,0,-1,-1,-1,0,2147483647,2147483647,-1,-1,-1,0,2147483647,-1,2147483647,0,0,2147483647,0,2147483647,-1,0},{0,2147483647,2147483647,2147483647,-1,0,2147483647,-1,0,0,2147483647,2147483647,2147483647,0,0,2147483647,0,0,0,0,2147483647,0,2147483647,-1,0,-1,2147483647,0,2147483647,2147483647,2147483647,-1,0,0,0,2147483647,0,2147483647,-1,2147483647,0},{2147483647,2147483647,2147483647,-1,2147483647,-1,2147483647,-1,0,0,-1,0,0,2147483647,-1,-1,-1,-1,0,0,0,-1,2147483647,2147483647,2147483647,-1,-1,0,-1,2147483647,0,-1,-1,-1,2147483647,2147483647,0,0,-1,2147483647,2147483647}};

        long start = System.currentTimeMillis();
        sol.wallsAndGates(rooms2);
        System.out.println(System.currentTimeMillis() - start);
        /*
        for (int[] r : rooms2) {
            System.out.println(Arrays.toString(r));
        }*/

    }
}
